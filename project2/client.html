<!DOCTYPE html>
<html>
<head>
  <title>Temp and Humidity Webpage</title>
    <meta charset="utf-8" />
    <style type="text/css">
      body {
        text-align: center;
        min-width: 500px;
      }
    </style>

  <script src="http://code.jquery.com/jquery.min.js"></script>
  <script>

       // log information to page
      log = function(data){
        $("div#terminal").prepend("</br>" +data);
        console.log(data);
      };
      
      
      $(document).ready(function () {
        $("div#message_details").hide()
 
        var ws;
 
 
 
        // create websocket instance
        ws = new WebSocket('ws://localhost:8888/ws');
           
        // Handle incoming websocket message callback
        ws.onmessage = function(evt) {
          log("Message Received from tornado: " + evt.data)
          alert("message received from tornado: " + evt.data);
          };
 
        // Close Websocket callback
        ws.onclose = function(evt) {
          log("***Tornado Server Connection Closed***");
          alert("Tornado Server Connection close");
          };
 
        // Open Websocket callback
        ws.onopen = function(evt) { 
          $("div#message_details").show();
          log("***Tornado Server Connection Opened**");
          };
        });
 
        // Send websocket message function
        $("#send").click(function(evt) {
            log("Sending Message: "+$("#message").val());
            ws.send($("#message").val());
        });
 
      
      //open websocket to node js/sql server
      const node_ws = new WebSocket('ws://localhost:8080');
      node_ws.onopen = function() {
          console.log('WebSocket Client Connected');
          node_ws.send('Message received from Client.');
          log("***Node_js/mySQL Connection Opened**");
      };
      node_ws.onmessage = function(e) {
        console.log("Received: '" + e.data + "'");
      };
      
      node_ws.onclose = function(e) {
            log("***Node_js/mySQL Connection Closed***");
          }
      node_ws.onerror = (error) => {
        console.log(`WebSocket error: ${error}`);
      };
 
  </script>
</head>
 <body>
    <h1>DHT22 Web Interface</h1>
    <div id="connection_details">
    </div>
    <div id="message_details">
        </br></br>
        <label for="message">message:</label>
        <input type="text" id="message" value="Hello World!"/><br />
        <input type="submit" id="send" value="send" />
    </div>
    <div id="terminal">
        
    </div>
  </body>
</html>
